<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Article 2 Jeopardy!</title>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;600;700&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root {
    --blue: #1a3a8f;
    --dark-blue: #0d1f5c;
    --gold: #f0c040;
    --gold-dark: #c9a020;
    --white: #ffffff;
    --light: #e8eaf6;
    --correct: #2e7d32;
    --wrong: #c62828;
    --dd-color: #e65100;
    --shadow: 0 4px 20px rgba(0,0,0,0.4);
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Oswald', sans-serif;
    background: var(--dark-blue);
    color: var(--white);
    min-height: 100vh;
    overflow-x: hidden;
  }
  .star-bg {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: radial-gradient(ellipse at 20% 20%, #1a2a7a 0%, #0a0f3d 50%, #050820 100%);
    z-index: -1;
  }
  .star-bg::after {
    content: '';
    position: absolute; top:0; left:0; width:100%; height:100%;
    background-image: radial-gradient(1px 1px at 10% 15%, rgba(255,255,255,0.6) 0%, transparent 100%),
      radial-gradient(1px 1px at 30% 45%, rgba(255,255,255,0.4) 0%, transparent 100%),
      radial-gradient(1px 1px at 55% 20%, rgba(255,255,255,0.5) 0%, transparent 100%),
      radial-gradient(1px 1px at 75% 60%, rgba(255,255,255,0.3) 0%, transparent 100%),
      radial-gradient(1px 1px at 90% 35%, rgba(255,255,255,0.6) 0%, transparent 100%),
      radial-gradient(1px 1px at 15% 75%, rgba(255,255,255,0.4) 0%, transparent 100%),
      radial-gradient(1px 1px at 65% 85%, rgba(255,255,255,0.3) 0%, transparent 100%);
  }

  header {
    text-align: center;
    padding: 18px 20px 10px;
  }
  header h1 {
    font-size: 2.8rem;
    font-weight: 700;
    color: var(--gold);
    text-shadow: 0 2px 12px rgba(240,192,64,0.5), 3px 3px 0 rgba(0,0,0,0.4);
    letter-spacing: 4px;
    text-transform: uppercase;
  }
  header h2 {
    font-size: 1.1rem;
    color: var(--light);
    letter-spacing: 2px;
    margin-top: 4px;
    opacity: 0.8;
  }
  .round-label {
    font-size: 1.3rem;
    color: var(--gold);
    letter-spacing: 3px;
    margin: 6px 0 2px;
    text-align: center;
  }

  /* SCOREBOARD */
  .scoreboard {
    display: flex;
    justify-content: center;
    gap: 14px;
    padding: 10px 20px;
    flex-wrap: wrap;
  }
  .team-score {
    background: rgba(255,255,255,0.08);
    border: 2px solid var(--gold);
    border-radius: 10px;
    padding: 8px 18px;
    text-align: center;
    min-width: 130px;
    transition: transform 0.2s, background 0.3s;
    cursor: pointer;
    position: relative;
  }
  .team-score.active-team {
    background: rgba(240,192,64,0.2);
    transform: scale(1.05);
    box-shadow: 0 0 16px rgba(240,192,64,0.5);
  }
  .team-score .team-name {
    font-size: 0.8rem;
    letter-spacing: 1px;
    opacity: 0.8;
  }
  .team-score input.team-name-input {
    background: transparent;
    border: none;
    border-bottom: 1px solid rgba(255,255,255,0.3);
    color: var(--white);
    font-family: 'Oswald', sans-serif;
    font-size: 0.85rem;
    width: 100px;
    text-align: center;
    letter-spacing: 1px;
    outline: none;
  }
  .team-score .score-val {
    font-size: 1.6rem;
    font-weight: 700;
    color: var(--gold);
  }

  /* GAME BOARD */
  .board-container {
    padding: 10px 16px 6px;
    max-width: 1100px;
    margin: 0 auto;
  }
  .board {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 8px;
  }
  .cat-header {
    background: var(--blue);
    border: 2px solid rgba(255,255,255,0.15);
    border-radius: 8px;
    text-align: center;
    padding: 10px 6px;
    font-size: 0.85rem;
    font-weight: 700;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--white);
    min-height: 60px;
    display: flex; align-items: center; justify-content: center;
  }
  .cell {
    background: var(--blue);
    border: 2px solid rgba(255,255,255,0.1);
    border-radius: 8px;
    text-align: center;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--gold);
    cursor: pointer;
    padding: 14px 6px;
    min-height: 70px;
    display: flex; align-items: center; justify-content: center;
    transition: background 0.2s, transform 0.15s, box-shadow 0.2s;
    text-shadow: 1px 1px 4px rgba(0,0,0,0.5);
  }
  .cell:hover:not(.used) {
    background: #2952c4;
    transform: scale(1.04);
    box-shadow: var(--shadow);
  }
  .cell.used {
    background: #0d1f4a;
    color: transparent;
    cursor: default;
    border-color: rgba(255,255,255,0.05);
  }
  .cell.daily-double:not(.used)::after {
    content: '‚òÖ';
    position: absolute;
    top: 4px; right: 6px;
    font-size: 0.7rem;
    color: var(--dd-color);
  }
  .cell { position: relative; }

  /* MODAL */
  .overlay {
    display: none;
    position: fixed; top:0; left:0; width:100%; height:100%;
    background: rgba(0,0,20,0.88);
    z-index: 100;
    align-items: center;
    justify-content: center;
  }
  .overlay.show { display: flex; }
  .modal {
    background: linear-gradient(135deg, #0d2080, #1a3a8f);
    border: 3px solid var(--gold);
    border-radius: 16px;
    padding: 36px 40px;
    max-width: 680px;
    width: 92%;
    text-align: center;
    box-shadow: 0 0 60px rgba(240,192,64,0.3);
    animation: popIn 0.25s ease;
    position: relative;
  }
  @keyframes popIn {
    from { transform: scale(0.85); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }
  .modal .category-tag {
    font-size: 0.8rem;
    letter-spacing: 2px;
    color: var(--gold);
    opacity: 0.8;
    margin-bottom: 8px;
    text-transform: uppercase;
  }
  .modal .point-val {
    font-size: 2.2rem;
    color: var(--gold);
    font-weight: 700;
    margin-bottom: 16px;
  }
  .modal .question-text {
    font-family: 'Merriweather', serif;
    font-size: 1.35rem;
    line-height: 1.6;
    color: var(--white);
    margin-bottom: 28px;
  }
  .modal .answer-text {
    font-family: 'Merriweather', serif;
    font-size: 1.1rem;
    color: #90caf9;
    background: rgba(0,0,0,0.3);
    border-radius: 8px;
    padding: 14px 20px;
    margin-bottom: 24px;
    display: none;
    line-height: 1.5;
  }
  .modal .answer-text.show { display: block; }
  .dd-banner {
    background: var(--dd-color);
    color: white;
    font-size: 1.6rem;
    font-weight: 700;
    letter-spacing: 3px;
    padding: 10px 24px;
    border-radius: 8px;
    margin-bottom: 16px;
    display: none;
    animation: flash 0.5s ease;
  }
  @keyframes flash {
    0%,100% { opacity: 1; } 50% { opacity: 0.4; }
  }
  .btn-row {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    justify-content: center;
    margin-top: 8px;
  }
  .btn {
    font-family: 'Oswald', sans-serif;
    font-size: 1rem;
    font-weight: 600;
    letter-spacing: 1px;
    padding: 10px 22px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    transition: transform 0.15s, box-shadow 0.15s;
  }
  .btn:hover { transform: scale(1.05); }
  .btn-reveal { background: var(--gold); color: #000; }
  .btn-correct { background: var(--correct); color: #fff; }
  .btn-wrong { background: var(--wrong); color: #fff; }
  .btn-close { background: rgba(255,255,255,0.15); color: #fff; }
  .btn-gold { background: var(--gold); color: #000; }

  /* TEAM SELECTOR */
  .team-picker {
    display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; margin-bottom: 20px;
  }
  .team-btn {
    font-family: 'Oswald', sans-serif;
    font-size: 0.9rem;
    padding: 8px 18px;
    border-radius: 8px;
    border: 2px solid var(--gold);
    background: transparent;
    color: var(--gold);
    cursor: pointer;
    transition: background 0.2s, color 0.2s;
  }
  .team-btn.selected { background: var(--gold); color: #000; }

  /* FINAL JEOPARDY */
  .final-section {
    text-align: center;
    padding: 20px;
    max-width: 700px;
    margin: 0 auto;
  }
  .final-section h2 {
    font-size: 2rem;
    color: var(--gold);
    letter-spacing: 3px;
    margin-bottom: 6px;
  }
  .wager-inputs {
    display: flex; gap: 12px; flex-wrap: wrap; justify-content: center; margin: 16px 0;
  }
  .wager-box {
    background: rgba(255,255,255,0.08);
    border: 2px solid var(--gold);
    border-radius: 10px;
    padding: 10px 14px;
    text-align: center;
  }
  .wager-box label {
    display: block; font-size: 0.75rem; letter-spacing: 1px; opacity: 0.8; margin-bottom: 6px;
  }
  .wager-box input {
    background: transparent;
    border: none;
    border-bottom: 1px solid var(--gold);
    color: var(--gold);
    font-family: 'Oswald', sans-serif;
    font-size: 1.2rem;
    width: 90px;
    text-align: center;
    outline: none;
  }

  /* ROUND NAV */
  .round-nav {
    display: flex; justify-content: center; gap: 14px; margin: 8px 0 4px;
  }
  .round-tab {
    font-family: 'Oswald', sans-serif;
    font-size: 0.95rem;
    letter-spacing: 2px;
    padding: 8px 22px;
    border-radius: 8px;
    border: 2px solid var(--gold);
    background: transparent;
    color: var(--gold);
    cursor: pointer;
    transition: background 0.2s, color 0.2s;
  }
  .round-tab.active { background: var(--gold); color: #000; }

  /* SCORE ADJUST */
  .score-adj {
    position: absolute;
    top: 4px; left: 6px;
    display: flex; gap: 3px;
    opacity: 0;
    transition: opacity 0.2s;
  }
  .team-score:hover .score-adj { opacity: 1; }
  .score-adj button {
    background: rgba(255,255,255,0.15);
    border: none; color: white;
    border-radius: 4px; font-size: 0.65rem; cursor: pointer;
    padding: 1px 5px; font-family: 'Oswald', sans-serif;
  }

  .confetti-overlay { display: none; }

  /* DD wager */
  .dd-wager-area { margin-bottom: 16px; }
  .dd-wager-area input {
    background: rgba(255,255,255,0.1);
    border: 2px solid var(--dd-color);
    color: white;
    font-family: 'Oswald', sans-serif;
    font-size: 1.4rem;
    text-align: center;
    border-radius: 8px;
    padding: 8px 16px;
    width: 150px;
    outline: none;
  }

  @media (max-width: 600px) {
    header h1 { font-size: 1.8rem; }
    .cell { font-size: 1.1rem; min-height: 54px; }
    .cat-header { font-size: 0.7rem; }
    .modal { padding: 24px 18px; }
    .modal .question-text { font-size: 1.1rem; }
  }
</style>
</head>
<body>
<div class="star-bg"></div>

<header>
  <h1>‚öñÔ∏è Jeopardy!</h1>
  <h2>Article 2 of the U.S. Constitution</h2>
</header>

<!-- ROUND TABS -->
<div class="round-nav">
  <button class="round-tab active" onclick="showRound(1)">Round 1</button>
  <button class="round-tab" onclick="showRound(2)">Double Jeopardy</button>
  <button class="round-tab" onclick="showRound(3)">Final Jeopardy</button>
  <button class="round-tab" style="border-color:#e53935; color:#e53935;" onclick="resetGame()">üîÑ Reset</button>
</div>

<!-- SCOREBOARD -->
<div class="scoreboard" id="scoreboard"></div>

<!-- GAME BOARDS -->
<div class="board-container">
  <div id="round-label" class="round-label">JEOPARDY ROUND</div>
  <div class="board" id="game-board"></div>
</div>

<!-- MODAL OVERLAY -->
<div class="overlay" id="overlay">
  <div class="modal" id="modal">
    <div class="dd-banner" id="dd-banner">üéØ DAILY DOUBLE!</div>
    <div class="category-tag" id="modal-cat"></div>
    <div class="point-val" id="modal-pts"></div>
    <!-- DD Wager -->
    <div class="dd-wager-area" id="dd-wager-area" style="display:none">
      <label style="font-size:0.9rem; color:var(--gold); letter-spacing:1px; margin-bottom:6px; display:block">ENTER WAGER:</label>
      <input type="number" id="dd-wager-input" placeholder="$" min="0"/>
      <br><br>
      <button class="btn btn-gold" onclick="confirmDDWager()">Confirm Wager</button>
    </div>
    <div id="question-area" style="display:none">
      <div class="question-text" id="modal-q"></div>
      <div class="answer-text" id="modal-a"></div>
      <div class="team-picker" id="team-picker"></div>
      <div class="btn-row" id="btn-row">
        <button class="btn btn-reveal" onclick="revealAnswer()">Reveal Answer</button>
      </div>
      <div class="btn-row" id="score-btns" style="display:none">
        <button class="btn btn-correct" id="correct-btn" onclick="awardPoints(true)">‚úì Correct</button>
        <button class="btn btn-wrong" id="wrong-btn" onclick="awardPoints(false)">‚úó Incorrect</button>
        <button class="btn btn-close" onclick="closeModal()">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- FINAL JEOPARDY SECTION -->
<div class="final-section" id="final-section" style="display:none">
  <h2>FINAL JEOPARDY</h2>
  <p style="color:var(--gold); letter-spacing:2px; font-size:0.9rem; margin-bottom:16px">CATEGORY: CHECKS & BALANCES</p>
  <div class="wager-inputs" id="wager-inputs"></div>
  <button class="btn btn-gold" style="margin:10px 0" onclick="showFinalQuestion()">Show Question</button>
  <div id="final-q-area" style="display:none">
    <div class="modal" style="position:relative; margin:16px auto; animation:none; max-width:100%">
      <div class="question-text" style="margin-bottom:20px">Article 2 gives the President significant powers, but Congress has the ability to remove a President through a two-step process. Name both steps of that process, the body of Congress responsible for each step, and the vote required in the second step to remove the President from office.</div>
      <div class="answer-text show" id="final-answer" style="display:none">
        <strong>Answer:</strong> Step 1 ‚Äî The <strong>House of Representatives</strong> impeaches (formally charges) the President by a simple majority vote. Step 2 ‚Äî The <strong>Senate</strong> holds a trial and must vote by a <strong>two-thirds majority</strong> to convict and remove the President.
      </div>
      <div class="btn-row">
        <button class="btn btn-reveal" onclick="document.getElementById('final-answer').style.display='block'">Reveal Answer</button>
      </div>
      <div style="margin-top:20px">
        <p style="font-size:0.85rem; letter-spacing:1px; opacity:0.7; margin-bottom:10px">AWARD WAGERS:</p>
        <div id="final-award-btns" class="btn-row"></div>
      </div>
    </div>
  </div>
</div>

<script>
// ===== DATA =====
const rounds = [
  {
    label: "JEOPARDY ROUND",
    multiplier: 100,
    categories: [
      "The Executive Branch",
      "Presidential Powers",
      "Commander in Chief",
      "Elections & Terms",
      "Presidential Duties"
    ],
    questions: [
      // Category 0: The Executive Branch
      [
        { q: "This branch of government is described in Article 2 of the Constitution.", a: "The Executive Branch" },
        { q: "Article 2 gives executive power to this one person.", a: "The President of the United States" },
        { q: "This office is second in line to the presidency and is also mentioned in Article 2.", a: "The Vice President" },
        { q: "The President leads this branch, which also includes the Cabinet and federal agencies.", a: "The Executive Branch" },
        { q: "Article 2 states that the President must take this formal promise before entering office.", a: "The Oath of Office" },
      ],
      // Category 1: Presidential Powers
      [
        { q: "The President has the power to do this to a bill passed by Congress ‚Äî sending it back unsigned.", a: "Veto (reject) the bill" },
        { q: "The President can make these formal agreements with foreign countries, with Senate approval.", a: "Treaties" },
        { q: "With Senate approval, the President can name people to fill these important government positions.", a: "Appointments (Cabinet members, judges, ambassadors)" },
        { q: "The President has the power to grant this to people convicted of federal crimes ‚Äî forgiving them.", a: "A pardon" },
        { q: "This special type of veto happens when the President ignores a bill for 10 days while Congress is not in session, and the bill automatically dies.", a: "A Pocket Veto" },
      ],
      // Category 2: Commander in Chief
      [
        { q: "Article 2 names the President as Commander in Chief of this.", a: "The Army, Navy, and state militias (military forces)" },
        { q: "Even though the President commands the military, only this branch can officially declare war.", a: "Congress (Legislative Branch)" },
        { q: "This is the civilian title of the President's role over the military, ensuring the military answers to elected officials.", a: "Commander in Chief" },
        { q: "The President can call state militias ‚Äî today known as this ‚Äî into national service.", a: "The National Guard" },
        { q: "As Commander in Chief, the President works closely with this department that oversees the military.", a: "The Department of Defense" },
      ],
      // Category 3: Elections & Terms
      [
        { q: "A President serves a term of this many years.", a: "Four years" },
        { q: "The Constitution's Article 2 requires the President to be at least this old.", a: "35 years old" },
        { q: "Article 2 requires the President to be this type of citizen ‚Äî not someone who moved here from another country.", a: "A natural-born citizen" },
        { q: "Article 2 says the President must have lived in the United States for at least this many years.", a: "14 years" },
        { q: "Article 2 created this special group of state-chosen representatives who officially elect the President.", a: "The Electoral College" },
      ],
      // Category 4: Presidential Duties
      [
        { q: "Article 2 requires the President to give Congress information about this on a regular basis ‚Äî today it's a famous speech.", a: "The State of the Union" },
        { q: "The President must 'faithfully execute' these ‚Äî the laws passed by Congress.", a: "The laws of the United States" },
        { q: "The President lives and works in this famous building in Washington, D.C.", a: "The White House" },
        { q: "The President receives advice from this group of department heads, though the Cabinet is not specifically named in Article 2.", a: "The Cabinet" },
        { q: "The Constitution requires the President to do this if he cannot fulfill his duties ‚Äî temporarily transferring power to the Vice President in writing.", a: "Invoke the 25th Amendment / send a written declaration to Congress" },
      ],
    ],
    // Daily Double: [col, row] (0-indexed, row 0 = top value)
    dailyDouble: [2, 3],
  },
  {
    label: "DOUBLE JEOPARDY ROUND",
    multiplier: 200,
    categories: [
      "Potpourri",
      "Checks & Balances",
      "Presidential History",
      "Impeachment",
      "Vice Presidency"
    ],
    questions: [
      // Category 0: Potpourri
      [
        { q: "This is the name of the President's official office located in the West Wing of the White House.", a: "The Oval Office" },
        { q: "He was the first President to be impeached by the House of Representatives.", a: "Andrew Johnson (1868)" },
        { q: "George Washington set this important informal tradition that limited Presidents to two terms, even though Article 2 did not require it.", a: "Serving only two terms" },
        { q: "This President was the first to have the 25th Amendment invoked, temporarily transferring power to the Vice President during a medical procedure.", a: "Ronald Reagan (1985)" },
        { q: "The President's official country retreat, located in the mountains of Maryland, has been used for rest, meetings, and peace negotiations ‚Äî including the famous 1978 Middle East peace talks.", a: "Camp David" },
      ],
      // Category 1: Checks & Balances
      [
        { q: "The President can check Congress by doing this to a bill ‚Äî blocking it from becoming law.", a: "Vetoing the bill" },
        { q: "Congress can check the President's veto by doing this with a two-thirds vote.", a: "Overriding the veto" },
        { q: "The Senate checks the President's appointment power by doing this to confirm nominees.", a: "Providing 'advice and consent' / voting to confirm" },
        { q: "The Supreme Court can check the President by declaring a presidential action this.", a: "Unconstitutional" },
        { q: "This congressional power ‚Äî described in Article 2 Section 4 ‚Äî is the ultimate check on the President.", a: "Impeachment (and removal from office)" },
      ],
      // Category 2: Presidential History
      [
        { q: "He was the first President to serve under the Constitution created in part by Article 2.", a: "George Washington" },
        { q: "This amendment, added in 1951, limits Presidents to two terms ‚Äî a rule not in the original Article 2.", a: "The 22nd Amendment" },
        { q: "Andrew Johnson and Bill Clinton were both subjected to this Article 2 process, but were not removed.", a: "Impeachment" },
        { q: "Richard Nixon was the only President in U.S. history to resign from office in 1974 due to the Watergate Scandal. Just one year earlier, his Vice President also resigned due to a bribery scandal ‚Äî name that Vice President.", a: "Spiro Agnew" },
        { q: "The President's term officially begins on this date each January.", a: "January 20th (Inauguration Day)" },
      ],
      // Category 3: Impeachment
      [
        { q: "This chamber of Congress has the sole power to impeach (formally charge) a President.", a: "The House of Representatives" },
        { q: "After impeachment by the House, the President's trial is held in this chamber.", a: "The Senate" },
        { q: "Article 2 says a President can be impeached for treason, bribery, or these ‚Äî vague but serious offenses.", a: "'High crimes and misdemeanors'" },
        { q: "This fraction of the Senate must vote to convict and remove a President from office.", a: "Two-thirds (2/3)" },
        { q: "If the President is removed through impeachment, this person takes over the presidency.", a: "The Vice President" },
      ],
      // Category 4: Vice Presidency
      [
        { q: "Article 2 states that if the President dies or cannot serve, this person takes over.", a: "The Vice President" },
        { q: "The Vice President is also the president of this congressional body, though they only vote to break ties.", a: "The Senate" },
        { q: "This amendment updated the rules for presidential succession beyond what Article 2 originally stated.", a: "The 25th Amendment" },
        { q: "Originally under Article 2, the person who came in second in the presidential election became this.", a: "The Vice President" },
        { q: "Gerald Ford holds a unique place in American history ‚Äî he is the only person to serve as both Vice President and President without being elected to either office. He became VP when this man resigned due to a bribery scandal, and then became President when this other man resigned due to Watergate.", a: "Spiro Agnew (VP resignation) and Richard Nixon (President resignation)" },
      ],
    ],
    dailyDouble: [3, 2],
  },
];

// ===== STATE =====
let teams = [
  { name: "Team 1", score: 0 },
  { name: "Team 2", score: 0 },
  { name: "Team 3", score: 0 },
  { name: "Team 4", score: 0 },
];
let currentRound = 0;
let used = [Array(5).fill(null).map(() => Array(5).fill(false)), Array(5).fill(null).map(() => Array(5).fill(false))];
let currentCell = null;
let currentPoints = 0;
let selectedTeam = null;
let isDailyDouble = false;
let ddWager = 0;

// ===== INIT =====
function init() {
  renderScoreboard();
  renderBoard(0);
}

function renderScoreboard() {
  const sb = document.getElementById('scoreboard');
  sb.innerHTML = '';
  teams.forEach((t, i) => {
    const div = document.createElement('div');
    div.className = 'team-score' + (selectedTeam === i ? ' active-team' : '');
    div.id = `team-${i}`;
    div.innerHTML = `
      <div class="score-adj">
        <button onclick="adjustScore(${i}, 200, event)">+$</button>
        <button onclick="adjustScore(${i}, -200, event)">-$</button>
      </div>
      <input class="team-name-input" value="${t.name}" onchange="teams[${i}].name=this.value; renderScoreboard()" />
      <div class="score-val" id="score-val-${i}">$${t.score.toLocaleString()}</div>
    `;
    sb.appendChild(div);
  });
}

function adjustScore(teamIdx, amount, e) {
  e.stopPropagation();
  teams[teamIdx].score += amount;
  document.getElementById(`score-val-${teamIdx}`).textContent = '$' + teams[teamIdx].score.toLocaleString();
}

function renderBoard(roundIdx) {
  const board = document.getElementById('game-board');
  board.innerHTML = '';
  document.getElementById('round-label').textContent = rounds[roundIdx].label;
  const r = rounds[roundIdx];
  const dd = r.dailyDouble;
  // Headers
  r.categories.forEach(cat => {
    const h = document.createElement('div');
    h.className = 'cat-header';
    h.textContent = cat;
    board.appendChild(h);
  });
  // Rows
  for (let row = 0; row < 5; row++) {
    const pts = r.multiplier * (row + 1);
    for (let col = 0; col < 5; col++) {
      const cell = document.createElement('div');
      cell.className = 'cell' + (used[roundIdx][col][row] ? ' used' : '');
      const isDD = dd[0] === col && dd[1] === row;
      if (isDD && !used[roundIdx][col][row]) cell.classList.add('daily-double');
      if (!used[roundIdx][col][row]) {
        cell.textContent = '$' + pts.toLocaleString();
        cell.onclick = () => openQuestion(roundIdx, col, row, pts, isDD);
      }
      board.appendChild(cell);
    }
  }
}

function openQuestion(roundIdx, col, row, pts, isDD) {
  if (used[roundIdx][col][row]) return;
  currentCell = { roundIdx, col, row };
  currentPoints = pts;
  isDailyDouble = isDD;
  selectedTeam = null;

  const q = rounds[roundIdx].questions[col][row];
  document.getElementById('modal-cat').textContent = rounds[roundIdx].categories[col];
  document.getElementById('modal-pts').textContent = '$' + pts.toLocaleString();
  document.getElementById('modal-q').textContent = q.q;
  document.getElementById('modal-a').textContent = 'Answer: ' + q.a;
  document.getElementById('modal-a').classList.remove('show');

  document.getElementById('dd-banner').style.display = isDD ? 'block' : 'none';
  document.getElementById('dd-wager-area').style.display = isDD ? 'block' : 'none';
  document.getElementById('question-area').style.display = isDD ? 'none' : 'block';
  document.getElementById('score-btns').style.display = 'none';
  document.getElementById('btn-row').style.display = 'flex';

  if (!isDD) buildTeamPicker();
  else {
    document.getElementById('dd-wager-input').value = '';
  }

  document.getElementById('overlay').classList.add('show');
}

function buildTeamPicker() {
  const tp = document.getElementById('team-picker');
  tp.innerHTML = '<div style="font-size:0.8rem;letter-spacing:1px;opacity:0.7;margin-bottom:6px;width:100%;text-align:center">ANSWERING TEAM:</div>';
  teams.forEach((t, i) => {
    const btn = document.createElement('button');
    btn.className = 'team-btn' + (selectedTeam === i ? ' selected' : '');
    btn.textContent = t.name;
    btn.onclick = () => {
      selectedTeam = i;
      document.querySelectorAll('.team-btn').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
      renderScoreboard();
    };
    tp.appendChild(btn);
  });
}

function confirmDDWager() {
  const val = parseInt(document.getElementById('dd-wager-input').value) || 0;
  ddWager = val;
  document.getElementById('dd-wager-area').style.display = 'none';
  document.getElementById('question-area').style.display = 'block';
  document.getElementById('modal-pts').textContent = 'Wager: $' + ddWager.toLocaleString();
  buildTeamPicker();
}

function revealAnswer() {
  document.getElementById('modal-a').classList.add('show');
  document.getElementById('btn-row').style.display = 'none';
  document.getElementById('score-btns').style.display = 'flex';
  const pts = isDailyDouble ? ddWager : currentPoints;
  document.getElementById('correct-btn').textContent = '‚úì Correct (+$' + pts.toLocaleString() + ')';
  document.getElementById('wrong-btn').textContent = '‚úó Incorrect (-$' + pts.toLocaleString() + ')';
}

function awardPoints(correct) {
  const pts = isDailyDouble ? ddWager : currentPoints;
  if (selectedTeam !== null) {
    teams[selectedTeam].score += correct ? pts : -pts;
    document.getElementById(`score-val-${selectedTeam}`).textContent = '$' + teams[selectedTeam].score.toLocaleString();
  }
  closeModal();
}

function closeModal() {
  if (currentCell) {
    const { roundIdx, col, row } = currentCell;
    used[roundIdx][col][row] = true;
    renderBoard(roundIdx);
    currentCell = null;
  }
  document.getElementById('overlay').classList.remove('show');
  selectedTeam = null;
  renderScoreboard();
}

// ===== ROUND NAVIGATION =====
function showRound(n) {
  document.querySelectorAll('.round-tab').forEach((t, i) => t.classList.toggle('active', i === n - 1));
  document.getElementById('game-board').style.display = n === 3 ? 'none' : 'grid';
  document.getElementById('round-label').style.display = n === 3 ? 'none' : 'block';
  document.getElementById('final-section').style.display = n === 3 ? 'block' : 'none';
  if (n === 1) renderBoard(0);
  if (n === 2) renderBoard(1);
  if (n === 3) buildFinalJeopardy();
}

function buildFinalJeopardy() {
  const wi = document.getElementById('wager-inputs');
  wi.innerHTML = '';
  teams.forEach((t, i) => {
    const div = document.createElement('div');
    div.className = 'wager-box';
    div.innerHTML = `
      <label>${t.name} (Score: $${t.score.toLocaleString()})</label>
      <input type="number" id="fj-wager-${i}" placeholder="Wager" min="0" max="${Math.max(t.score,0)}" />
    `;
    wi.appendChild(div);
  });
  document.getElementById('final-q-area').style.display = 'none';
  document.getElementById('final-award-btns').innerHTML = '';
}

function showFinalQuestion() {
  document.getElementById('final-q-area').style.display = 'block';
  document.getElementById('final-answer').style.display = 'none';

  // Build award buttons
  const ab = document.getElementById('final-award-btns');
  ab.innerHTML = '';
  teams.forEach((t, i) => {
    const wager = parseInt(document.getElementById(`fj-wager-${i}`)?.value) || 0;
    const cBtn = document.createElement('button');
    cBtn.className = 'btn btn-correct';
    cBtn.style.fontSize = '0.75rem';
    cBtn.textContent = `${t.name} ‚úì +$${wager.toLocaleString()}`;
    cBtn.onclick = () => { teams[i].score += wager; renderScoreboard(); cBtn.disabled = true; };

    const wBtn = document.createElement('button');
    wBtn.className = 'btn btn-wrong';
    wBtn.style.fontSize = '0.75rem';
    wBtn.textContent = `${t.name} ‚úó -$${wager.toLocaleString()}`;
    wBtn.onclick = () => { teams[i].score -= wager; renderScoreboard(); wBtn.disabled = true; };

    ab.appendChild(cBtn);
    ab.appendChild(wBtn);
  });
}


// ===== RESET =====
function resetGame() {
  if (!confirm('Reset the game? All scores and used questions will be cleared.')) return;
  teams = [
    { name: "Team 1", score: 0 },
    { name: "Team 2", score: 0 },
    { name: "Team 3", score: 0 },
    { name: "Team 4", score: 0 },
  ];
  used = [Array(5).fill(null).map(() => Array(5).fill(false)), Array(5).fill(null).map(() => Array(5).fill(false))];
  currentCell = null; currentPoints = 0; selectedTeam = null; isDailyDouble = false; ddWager = 0;
  document.querySelectorAll('.round-tab').forEach((t, i) => t.classList.toggle('active', i === 0));
  document.getElementById('game-board').style.display = 'grid';
  document.getElementById('round-label').style.display = 'block';
  document.getElementById('final-section').style.display = 'none';
  renderScoreboard();
  renderBoard(0);
}

// ===== START =====
init();
</script>
</body>
</html>
